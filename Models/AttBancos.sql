-----------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------
Declare @Cmd Varchar(max), @BancoDados Varchar(255)

-----------------------------------------------------------------------------------------------------------------------------------------
Begin Try Drop Table #BancoDadosAfetados End Try Begin Catch End Catch
Create Table #BancoDadosAfetados(Banco varchar(255))

-----------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------


Declare CrBancos Cursor local static for
 
Select Name
From sys.databases
Where (Name not in('master', 'tempdb', 'model', 'msdb', 'MakroReport', 'MakroContabilProj', 'MakroReportTempDB')) 
and (Left(Name, 2) not in('Ts', 'Bk', 'NG', 'Zb'))


Open CrBancos
Fetch next from CrBancos into @BancoDados

While (@@FETCH_STATUS = 0)
  Begin	
		Set @Cmd = '

		-----------------------------------------------------------------------------------------------------------------------------------------
		Use  ' + @BancoDados + '
		-----------------------------------------------------------------------------------------------------------------------------------------
    ---------------------------------------------------------------------------------------------------------------------------------------

		Delete From CadNfeManifesto
		Where (cStat = 109)


		-----------------------------------------------------------------------------------------------------------------------------------------
		Print(''------------------------------------------------------------------------------------' + @BancoDados + ''')
		-----------------------------------------------------------------------------------------------------------------------------------------

'
		--Print(@Cmd)
		Exec(@Cmd)

		Fetch next from CrBancos into @BancoDados
	End

Close CrBancos
Deallocate CrBancos 


Select *
From #BancoDadosAfetados